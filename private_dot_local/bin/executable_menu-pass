#!/bin/sh
# requires: https://github.com/doy/rbw

set -eu

rbw unlocked || rbw unlock

full="$(rbw ls --fields name | $DMENU | xargs -r -I {} rbw get --full {})"
pswd="$(echo "$full" | head -n 1)"
user="$(echo "$full" | grep -i username | awk '{print $2}')"

# skip clipboard history: see ~/.local/libexec/clipboard-skip-or-store
[ -n "$pswd" ] && touch /tmp/clipboard-skip && echo "$pswd" | wl-copy
[ -n "$user" ] && echo "$user" | wl-copy --primary
